<?xml version="1.0" encoding="utf-8"?>
<root>
  <FlowItem>
    <FlowID>__term_callout</FlowID>
    <FlowName>坐席外呼</FlowName>
    <FlowDesc>系统流程－终端外呼</FlowDesc>
    <FlowVer>1.0</FlowVer>
    <CreateDate>2008年04月06日 12:14:59</CreateDate>
    <ModifyDate>2009年09月07日 11:23:17</ModifyDate>
    <DesignVer>2.0</DesignVer>
  </FlowItem>
  <FlowNode>
    <NodeID>1077</NodeID>
    <NodeType>SUBSTART</NodeType>
    <NodeName>子流程开始</NodeName>
    <ExtendedProperty>
    </ExtendedProperty>
    <PropertySet>
      <AffectList>
        <varlist>
          <var>termid</var>
        </varlist>
        <varlist>
          <var>termtype</var>
        </varlist>
        <varlist>
          <var>termch</var>
        </varlist>
        <varlist>
          <var>termteleno</var>
        </varlist>
        <varlist>
          <var>agentid</var>
        </varlist>
        <varlist>
          <var>agentstate</var>
        </varlist>
        <varlist>
          <var>src_sessionid</var>
        </varlist>
        <varlist>
          <var>src_talkid</var>
        </varlist>
        <varlist>
          <var>callingno</var>
        </varlist>
        <varlist>
          <var>calledno</var>
        </varlist>
        <varlist>
          <var>option</var>
        </varlist>
      </AffectList>
      <Exit>
        <ExitPort>
          <type>2</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>1</type>
          <targetflow>
          </targetflow>
          <target>1113</target>
        </ExitPort>
      </Exit>
    </PropertySet>
  </FlowNode>
  <FlowNode>
    <NodeID>1079</NodeID>
    <NodeType>TERMCONN</NodeType>
    <NodeName>连接终端</NodeName>
    <ExtendedProperty>SessionID=sessionid;MainChTermID=termid;WaitMode=0;ChTermIDList=callch;ConnMode=0;ConnDuration=60;Option=;OutTermID=;OutTalkID=;OutExitData=</ExtendedProperty>
    <PropertySet>
      <Exit>
        <ExitPort>
          <type>5</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>4</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>2</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>1</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
      </Exit>
    </PropertySet>
  </FlowNode>
  <FlowNode>
    <NodeID>1081</NodeID>
    <NodeType>TERMCONN</NodeType>
    <NodeName>连接终端</NodeName>
    <ExtendedProperty>SessionID=sessionid;MainChTermID=callch;WaitMode=1;ChTermIDList=termid;ConnMode=3;ConnDuration=3600;Option="IsCutDtmf=1";OutTermID=;OutTalkID=;OutExitData=</ExtendedProperty>
    <PropertySet>
      <Exit>
        <ExitPort>
          <type>5</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>4</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>2</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>1</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
      </Exit>
    </PropertySet>
  </FlowNode>
  <FlowNode>
    <NodeID>1082</NodeID>
    <NodeType>JUDGE</NodeType>
    <NodeName>判断</NodeName>
    <ExtendedProperty>
    </ExtendedProperty>
    <PropertySet>
      <switch>
        <case>
          <expression>termid &lt;= 0</expression>
          <ExitType>102</ExitType>
        </case>
        <case>
          <expression>src_sessionid &lt;= 0</expression>
          <ExitType>101</ExitType>
        </case>
      </switch>
      <Exit>
        <ExitPort>
          <type>2</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>102</type>
          <targetflow>
          </targetflow>
          <target>1118</target>
        </ExitPort>
        <ExitPort>
          <type>101</type>
          <targetflow>
          </targetflow>
          <target>1079</target>
        </ExitPort>
        <ExitPort>
          <type>100</type>
          <targetflow>
          </targetflow>
          <target>1081</target>
        </ExitPort>
      </Exit>
    </PropertySet>
  </FlowNode>
  <FlowNode>
    <NodeID>1087</NodeID>
    <NodeType>JUDGE</NodeType>
    <NodeName>判断</NodeName>
    <ExtendedProperty>
    </ExtendedProperty>
    <PropertySet>
      <switch>
        <case>
          <expression>src_sessionid &gt; 0</expression>
          <ExitType>101</ExitType>
        </case>
      </switch>
      <Exit>
        <ExitPort>
          <type>2</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>101</type>
          <targetflow>
          </targetflow>
          <target>1088</target>
        </ExitPort>
        <ExitPort>
          <type>100</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
      </Exit>
    </PropertySet>
  </FlowNode>
  <FlowNode>
    <NodeID>1088</NodeID>
    <NodeType>SCRIPT</NodeType>
    <NodeName>脚本</NodeName>
    <ExtendedProperty>ZoneType=0;ScriptContent=TermContinueTalkMode(src_sessionid,src_talkid,termch)</ExtendedProperty>
    <PropertySet>
      <Exit>
        <ExitPort>
          <type>2</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>1</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
      </Exit>
    </PropertySet>
  </FlowNode>
  <FlowNode>
    <NodeID>1113</NodeID>
    <NodeType>LET</NodeType>
    <NodeName>赋值</NodeName>
    <ExtendedProperty>
    </ExtendedProperty>
    <PropertySet>
      <letlist>
        <let>
          <VarName>confid</VarName>
          <ZoneType>0</ZoneType>
          <Value>TermGetTalkConfID(src_sessionid,src_talkid)</Value>
        </let>
        <let>
          <VarName>connch</VarName>
          <ZoneType>0</ZoneType>
          <Value>termch</Value>
        </let>
        <let>
          <VarName>dialmode</VarName>
          <ZoneType>0</ZoneType>
          <Value>iif(calledno=='',1,0)</Value>
        </let>
      </letlist>
      <Exit>
        <ExitPort>
          <type>2</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>1</type>
          <targetflow>
          </targetflow>
          <target>1119</target>
        </ExitPort>
      </Exit>
    </PropertySet>
  </FlowNode>
  <FlowNode>
    <NodeID>1115</NodeID>
    <NodeType>SCRIPT</NodeType>
    <NodeName>脚本</NodeName>
    <ExtendedProperty>ZoneType=0;ScriptContent=if connch != termch:
	termid = -1</ExtendedProperty>
    <PropertySet>
      <Exit>
        <ExitPort>
          <type>2</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>1</type>
          <targetflow>
          </targetflow>
          <target>1082</target>
        </ExitPort>
      </Exit>
    </PropertySet>
  </FlowNode>
  <FlowNode>
    <NodeID>1118</NodeID>
    <NodeType>TERMCONN</NodeType>
    <NodeName>连接终端</NodeName>
    <ExtendedProperty>SessionID=sessionid;MainChTermID=callch;WaitMode=1;ChTermIDList=;ConnMode=0;ConnDuration=3600;Option="IsCutDtmf=1";OutTermID=;OutTalkID=;OutExitData=</ExtendedProperty>
    <PropertySet>
      <Exit>
        <ExitPort>
          <type>5</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>4</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>2</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
        <ExitPort>
          <type>1</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
      </Exit>
    </PropertySet>
  </FlowNode>
  <FlowNode>
    <NodeID>1119</NodeID>
    <NodeType>DIALEX</NodeType>
    <NodeName>拨号</NodeName>
    <ExtendedProperty>WorkCh=termid;Dnis=calledno;Ani=callingno;OrDnis=;AgConnDelay=;IsConnCh=1;RingVoice="systemvoice\tone_backring.wav";RingTimeout=50;IsStopPlay=1;IsCheckDialTone=0;OutChNo=callch;OutDnis=calledno;LinkNo=;PlayType=;CallDevGroup=;CallDev=;InteractiveMode=1;CallDevType=4;DtmfTime=10;Option="StopDialDtmf=*9;SessionID=%d;ConnDev2=%d;Hold2Conf=%d;DialMode"%(src_sessionid,confid,confid,dialmode);WorkDev2=0;OutSessionId=sessionid;OutConnCh=connch</ExtendedProperty>
    <PropertySet>
      <Exit>
        <ExitPort>
          <type>6</type>
          <targetflow>
          </targetflow>
          <target>1087</target>
        </ExitPort>
        <ExitPort>
          <type>4</type>
          <targetflow>
          </targetflow>
          <target>1087</target>
        </ExitPort>
        <ExitPort>
          <type>1</type>
          <targetflow>
          </targetflow>
          <target>1115</target>
        </ExitPort>
        <ExitPort>
          <type>2</type>
          <targetflow>
          </targetflow>
          <target>1087</target>
        </ExitPort>
        <ExitPort>
          <type>5</type>
          <targetflow>
          </targetflow>
          <target>
          </target>
        </ExitPort>
      </Exit>
    </PropertySet>
  </FlowNode>
</root>